<div>
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h4>{{ isAdmin ? 'Manage Policies' : 'Available Policies' }}</h4>
    <button *ngIf="isAdmin" class="btn btn-success" (click)="showAddForm = !showAddForm">Add Policy</button>
  </div>

  <div *ngIf="showAddForm && isAdmin" class="card mb-3">
    <div class="card-body">
      <h5>Add New Policy</h5>
      <form (ngSubmit)="addPolicy()">
        <div class="mb-2">
          <input type="text" class="form-control" placeholder="Policy Name" [(ngModel)]="newPolicy.name" name="name" required>
        </div>
        <div class="mb-2">
          <textarea class="form-control" placeholder="Description" [(ngModel)]="newPolicy.description" name="description"></textarea>
        </div>
        <div class="mb-2">
          <input type="number" class="form-control" placeholder="Premium" [(ngModel)]="newPolicy.premium" name="premium" required>
        </div>
        <button type="submit" class="btn btn-primary me-2">Add</button>
        <button type="button" class="btn btn-secondary" (click)="showAddForm = false">Cancel</button>
      </form>
    </div>
  </div>

  <div *ngIf="showEditForm && isAdmin" class="card mb-3">
    <div class="card-body">
      <h5>Edit Policy</h5>
      <form (ngSubmit)="updatePolicy()">
        <div class="mb-2">
          <input type="text" class="form-control" placeholder="Policy Name" [(ngModel)]="editingPolicy.name" name="editName" required>
        </div>
        <div class="mb-2">
          <textarea class="form-control" placeholder="Description" [(ngModel)]="editingPolicy.description" name="editDescription"></textarea>
        </div>
        <div class="mb-2">
          <input type="number" class="form-control" placeholder="Premium" [(ngModel)]="editingPolicy.premium" name="editPremium" required>
        </div>
        <button type="submit" class="btn btn-primary me-2">Update</button>
        <button type="button" class="btn btn-secondary" (click)="cancelEdit()">Cancel</button>
      </form>
    </div>
  </div>

  <div class="row">
    <div class="col-md-4 mb-3" *ngFor="let policy of policies">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">{{ policy.name }}</h5>
          <p class="card-text">{{ policy.description }}</p>
          <p class="card-text"><strong>â‚¹{{ policy.premium }}</strong></p>
          <button *ngIf="!isAdmin && showApplyButton" class="btn btn-primary" (click)="applyForPolicy(policy)">Apply</button>
          <div *ngIf="isAdmin">
            <button class="btn btn-warning me-2" (click)="editPolicy(policy)">Edit</button>
            <button class="btn btn-danger" (click)="deletePolicy(policy.id)">Delete</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <app-policy-apply (applied)="onApplicationSubmitted()"></app-policy-apply>
</div>